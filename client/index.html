<html>
    <head>
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
        <script src="http://code.jquery.com/jquery-2.1.1.js"></script>
        <script src="jquery.form.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
         <link rel="stylesheet" type="text/css" href="css/index.css" />
            
        <title>Webimg Compress</title>

    </head>
    <body>
        <div class="container-fluid">
             <div class="main-body">

                <div class="top-bar row" >
                       <h1 class="col-md-10" > Resize and Optimize</h1>
                </div> 

                <div class="row selection-section"   >
                 <form action='http://192.168.1.4:8123/compress/' method="post" enctype="multipart/form-data" id="image-submit-form" >
                     
                    <input class="btn-default btn-file" title="Select File"  type='file' id='imgfile' name='image' multiple/>
                    <!--<input type="hidden" value="debanjana.maitra@gmail.com" name="from" />
                    <input type="hidden" value="text-value" name="body" />
                    <input type="hidden" value="subject-value" name="subject"/>
                    <input type='hidden' vallue='callback' name='callback'/>-->
                                                                                                                                                                                                                                                                    
                        

                    <div class="row ">
                         <input id="upload-button" type="submit" class=" upload-section  btn btn-primary col-md-2 buttonStyle"  name="upload-button"/>
                        <div class="progress upload-section">
                          <div id="upload-progress" class="progress-bar progress-bar-striped active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%" >
                         <span class="sr-only">45% Complete</span>
                              </div>
                            </div>
                  </div>
                
                </form>
                <br>
                <span id="download_link" class="row download-section">

                    <a href='www.google.com'  id='download_compressed_images_link' >  <img src="img/download.svg" >  </a>
                </span>
                

       </div>
   </div>
    </body>
            <script type='text/javascript'>

        //ajax call

 function setUploadFormSubmit(){

    var options={
        success : showResponse,
        failue : showError,
        uploadProgress: calculateProgress
    };
 
    $('form#image-submit-form').ajaxForm(options);
    return false;
}

    function calculateProgress(event,position,total,percentComplete)
    {

        console.log(percentComplete);
        $('#upload-progress').attr('aria-valuenow' ,  percentComplete) ;
        $('#upload-progress').css('width' , percentComplete+'%');

    }


    function showError(){

      reset_progress_bar();
      alert( "Error processing images : " + response.a );

    }
    function showResponse(response, status, xhr, $form)  { 
       alert('status: ' +  '\n\nresponseText: \n' + response.a ); 
       $("a#download_compressed_images_link").attr("href", '/'+response.a)

       // update progress bar
       reset_progress_bar();
       $("#download_link").css("display","hidden");
    }

    function show_download_link(){
         $("#download_link").css("display","block");
    }

    function hide_download_link(){
         $("#download_link").css("display","none");
    }

    function reset_progress_bar(){
      // update progress bar
       $('#upload-progress').attr('aria-valuenow' ,  '0') ;
       $('#upload-progress').css('width' , '0%');
    }

    $(document).ready(function(){
        setUploadFormSubmit();
        hide_download_link();
    });

</script>
</html>

